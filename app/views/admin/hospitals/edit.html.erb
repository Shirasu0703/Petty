<% if @hospital.errors.any? %>
  <%= @hospital.errors.count %>件のエラーが発生しました
  <ul>
    <% @hospital.errors.full_messages.each do |message| %>
      <li><%= message %></li>
    <% end %>
  </ul>
<% end %>

<h2 class="text-center my-4">病院編集</h2>
<div class="hospital-background d-flex justify-content-center align-items-center min-vh-100">
  <div class="card shadow-lg border-0" style="max-width: 700px; width: 90%; background: rgba(255, 255, 255, 0.9);">
    <%= form_with model: @hospital, url: admin_hospital_path(@hospital), method: :patch do |f| %>
      <div class="card-body">
        <div class="text-center mb-3">
          <strong><%= f.label :main_image, "見出し画像(1枚)" %></strong><br />
          <% if @hospital.main_image.attached? %>
            <div class="mb-2">
              <%= image_tag @hospital.main_image, class: "img-fluid rounded shadow-sm", style: "max-width: 300px;" %><br />
              <%= link_to "この画像を削除", remove_main_image_admin_hospital_path(@hospital), method: :delete, data: { confirm: "本当に削除しますか？"}, class: "btn btn-sm btn-outline-danger mt-2" %>
            </div>
          <% end %>

          <%= f.file_field :main_image, accept: "image/*", class: "form-control-file" %>
        </div>

        <!-- サブ画像表示・添付 -->
        <div class="m-3">
          <strong><%= f.label :sub_images, "サブ画像(複数選択可)" %></strong><br />
          <% if @hospital.sub_images.attached? %>
            <div class="d-flex flex-wrap fap-2 mb-2">
              <% @hospital.sub_images.each do |image| %>
                <div class="position-relative">
                  <%= image_tag image, class: "rounded shadow-sm", style: "width: 80px; height: 80px; object-fit: cover;" %>
                  <%= link_to "x", remove_sub_image_admin_hospital_path(@hospital, image_id: image.id), method: :delete, data: { confirm: "削除しますか？" }, class: "btn btn-sm btn-danger position-absolute top-0 end-0" %>
                </div>
              <% end %>
            </div>
          <% end %>
          <%= f.file_field :sub_images, multiple: true, accept: "image/*", class: "form-control-file" %>
        </div>

        <div class="mb-3">
          <strong><%= f.label :name, "施設名" %></strong>
          <p class="text-muted mb-0"><%= f.text_field :name, class: "form-control" %></p>
        </div>
        <div class="mb-3">
          <strong><%= f.label :address, "住所" %></strong>
          <p class="text-muted mb-0"><%= f.text_area :address, class: "form-control" %></p>
        </div>
        <div class="mb-3">
          <strong><%= f.label :phone_number, "連絡先" %></strong>
          <p class="text-muted mb-0"><%= f.text_field :phone_number, class: "form-control" %></p>
        </div>
        <div class="mb-3">
          <strong><%= f.label :opening_hours, "診察時間" %></strong>
          <p class="text-muted mb-0"><%= f.text_area :opening_hours, class: "form-control" %></p>
        </div>
        <div class="mb-3">
          <strong><%= f.label :aninal_types, "診察対応動物" %></strong>
          <p class="text-muted mb-0"><%= f.text_field :animal_types, class: "form-control" %></p>
        </div>
        
        <div class="d-flex mb-3">
          <%= f.submit "更新", class: "btn btn-warning w-50" %>
          <%= link_to "削除", admin_hospital_path(@hospital), method: :delete, data: { confirm: "本当に削除しますか？" }, class: "btn btn-danger w-50" %>
        </div>
      </div>
    <% end %>
    <div class="d-flex mb-3">
      <%= link_to "病院一覧に戻る", admin_hospitals_path, class: "btn btn-warning w-50" %>
      <%= link_to "病院詳細に戻る", admin_hospital_path(@hospital), class: "btn btn-warning w-50" %>
    </div>
  </div>
</div>
