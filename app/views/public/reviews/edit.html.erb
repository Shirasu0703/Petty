<% if @review.errors.any? %>
  <%= @review.errors.count %>件のエラーが発生しました
  <ul>
    <% @review.errors.full_messages.each do |message| %>
      <li><%= message %></li>
    <% end %>
  </ul>
<% end %>

<div class="container form-color mt-4 mb-4">
<h2 class="text-center table-warning my-4">レビュー編集</h2>
  <%= form_with model: @review, url: public_hospital_review_path(@review.hospital, @review), method: :patch do |f| %>

  <hr>
  <div class="md-3 mb-3">
    <h4><%= f.label :cleanliness_comment, "清潔さ" %></h4>
    <%= render 'layouts/rating_form', object: @review, type: :cleanliness_rating, read_only: true, score: @review.cleanliness_rating %>
    <%= f.text_field :cleanliness_comment, class: "form-control border border-secondary" %>
  </div>

  <div class="md-3 mb-3">
    <h4><%= f.label :doctor_comment, "先生の対応" %></h4>
    <%= render 'layouts/rating_form', object: @review, type: :doctor_rating, read_only: true, score: @review.doctor_rating %>
    <%= f.text_field :doctor_comment, class: "form-control border border-secondary" %>
  </div>

  <div class="md-3 mb-3">
    <h4><%= f.label :staff_comment, "スタッフの対応" %></h4>
    <%= render 'layouts/rating_form', object: @review, type: :staff_rating, read_only: true, score: @review.staff_rating %>
    <%= f.text_field :staff_comment, class: "form-control border border-secondary" %>
  </div>

  <div class="md-3 mb-3">
    <h4><%= f.label :price_comment, "料金" %></h4>
    <%= render 'layouts/rating_form', object: @review, type: :price_rating, read_only: true, score: @review.price_rating %>
    <%= f.text_field :price_comment, class: "form-control border border-secondary" %>
  </div>

  <div class="md-3 mb-3">
    <h4><%= f.label :waiting_comment, "待ち時間" %></h4>
    <%= render 'layouts/rating_form', object: @review, type: :waiting_rating, read_only: true, score: @review.waiting_rating %>
    <%= f.text_field :waiting_comment, class: "form-control border border-secondary" %>
  </div>

  <div class="md-3 mb-3">
    <h4><%= f.label :title, "レビュータイトル" %></h4>
    <%= f.text_field :title, class: "form-control border border-secondary" %>
  </div>

  <div class="md-3 mb-3">
    <h4><%= f.label :body, "総合評価" %><//h4>
    <%= render 'layouts/rating_form', object: @review, type: :rating, read_only: true, score: @review.rating %>
    <%= f.text_area :body, row: 5, class: "form-control border border-secondary" %>
  </div>

  <div class="md-3 mb-3">
    <h4><%= f.label :animal_comment, "動物目線でひとこと！(任意)" %></h4>
    <%= f.text_field :animal_comment, class: "form-control border border-secondary" %>
  </div>

  <div class="mb-3 mb-3">
    <h4>現在のタグ</h4>
    <div class="d-flex flex-wrap mt-2">
      <% @review.tags.each do |tag| %>
        <div class="position-relative mr-2 mb-2">
          <span class="badge text-primary p-2 pr-4"><%= tag.tag %></span>
          <%= link_to "&times;".html_safe, remove_tag_public_hospital_review_path(@review.hospital, @review, tag_id: tag.id),
          method: :delete, data: { confirm: "「#{tag.tag}」を削除しますか？" },
          class: "btn btn-sm btn-danger position-absolute tag-style" %>
        </div>
      <% end %>
    </div>
  </div>
  <div class="mb-3 mb-3">
      <p>タグを選択</p>
    <% @tags.each do |tag| %>
      <%= check_box_tag "review[tag_ids][]", tag.id, @review.tags.include?(tag) %>
      <%= tag.tag %>
    <% end %>
    <div class="mt-3">
      <h4>新しいタグを入力（カンマ区切りで複数可）</h4>
      <%= text_field_tag "review[new_tag_names]", nil, placeholder: "例）夜間対応, 駐車場あり, 先生が優しい", class: "form-control" %>
    </div>
  </div>

  <div class="text-center my-3 mb-3">
    <%= f.submit "更新", class: "btn btn-warning w-25" %> 
    <%= link_to "削除", public_hospital_review_path(@review.hospital, @review), method: :delete, data: { confirm: "本当に削除しますか？" }, class: "btn btn-danger w-25" %>
  </div>
  <% end %>

  <div class="text-center">
    <%= link_to "詳細に戻る", public_hospital_review_path(@review.hospital, @review), class: "btn btn-link-color mb-3 w-25" %> 
    <%= link_to "一覧に戻る", public_hospital_reviews_path, class: "btn btn-link-color mb-3 w-25" %>
  </div>
</div>


